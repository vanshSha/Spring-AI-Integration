services:

  chroma:
    image: chromadb/chroma
    container_name: chroma
    ports:
      - "8000:8000"
    volumes:
      - chroma_data:/chroma

  redis:
    image: redis
    container_name: redis
    ports:
      - "6379:6379"
    volumes:
      - redis_data:/data
    command: redis-server --appendonly yes

  cassandra:
    image: cassandra
    container_name: cassandra
    ports:
      - "9042:9042"
    volumes:
      - cassandra_data:/var/lib/cassandra

  neo4j:
    image: neo4j:5.17
    container_name: neo4j
    restart: unless-stopped

    ports:
      - "7474:7474"   # Neo4j Browser (HTTP)
      - "7687:7687"   # Bolt protocol

    environment:
      # Authentication
      NEO4J_AUTH: neo4j/password

      # Memory (tune later)
      NEO4J_server_memory_heap_initial__size: 1G
      NEO4J_server_memory_heap_max__size: 2G
      NEO4J_server_memory_pagecache_size: 1G

      # Allow procedures (needed for vector indexes & plugins)
      NEO4J_dbms_security_procedures_unrestricted: "gds.*,apoc.*"
      NEO4J_dbms_security_procedures_allowlist: "gds.*,apoc.*"

    volumes:
      - neo4j_data:/data
      - neo4j_logs:/logs
      - neo4j_import:/var/lib/neo4j/import
      - neo4j_plugins:/plugins

  oracle-db:
    image: container-registry.oracle.com/database/free:23.5.0.0
    container_name: oracle23ai
    ports:
      - "1521:1521"   # SQL*Net
      - "5500:5500"   # EM Express
    environment:
      - ORACLE_PWD=mlops
      - ORACLE_CHARACTERSET=mlops
    volumes:
      - oracle-data:/opt/oracle/oradata
    restart: unless-stopped

  # Milvus Vectore Store
  etcd:
    container_name: milvus-etcd
    image: quay.io/coreos/etcd:v3.5.5
    environment:
      - ETCD_AUTO_COMPACTION_MODE=revision
      - ETCD_AUTO_COMPACTION_RETENTION=1000
      - ETCD_QUOTA_BACKEND_BYTES=4294967296
    command: >
      etcd
      -advertise-client-urls=http://0.0.0.0:2379
      -listen-client-urls=http://0.0.0.0:2379
      --data-dir=/etcd
    volumes:
      - ./volumes/etcd:/etcd
    ports:
      - "2379:2379"

  minio:
    container_name: milvus-minio
    image: minio/minio:RELEASE.2023-09-20T22-49-55Z
    environment:
      MINIO_ROOT_USER: minioadmin
      MINIO_ROOT_PASSWORD: minioadmin
    command: minio server /minio_data --console-address ":9001"
    volumes:
      - ./volumes/minio:/minio_data
    ports:
      - "9000:9000"
      - "9001:9001"

  milvus:
    container_name: milvus-standalone
    image: milvusdb/milvus:v2.4.4
    command: [ "milvus", "run", "standalone" ]
    environment:
      ETCD_ENDPOINTS: etcd:2379
      MINIO_ADDRESS: minio:9000
    volumes:
      - ./volumes/milvus:/var/lib/milvus
    ports:
      - "19530:19530"   # gRPC
      - "9091:9091"     # HTTP
    depends_on:
      - etcd
      - minio

  # UI ATTU of milvus
  attu:
    container_name: milvus-attu
    image: zilliz/attu:latest
    environment:
      MILVUS_URL: milvus:19530
    ports:
      - "8000:3000"
    depends_on:
      - milvus


  typesense:
    image: typesense/typesense:0.25.2
    container_name: typesense-server
    ports:
      - "8108:8108"
    volumes:
      - ./typesense-data:/data
    command: >
      --data-dir /data
      --api-key=xyz
      --enable-cors
    restart: unless-stopped

  weaviate:
    image: semitechnologies/weaviate:1.25.3
    container_name: weaviate
    ports:
      - "9090:8080"
    #    Host 9090 â†’ Container 8080
    environment:
      QUERY_DEFAULTS_LIMIT: 20
      AUTHENTICATION_ANONYMOUS_ACCESS_ENABLED: "true"
      PERSISTENCE_DATA_PATH: "/var/lib/weaviate"
      DEFAULT_VECTORIZER_MODULE: "none"
      CLUSTER_HOSTNAME: "node1"
    volumes:
      - weaviate_data:/var/lib/weaviate
    restart: unless-stopped

  qdrant:
    image: qdrant/qdrant:latest
    container_name: qdrant
    ports:
      - "6333:6333"   # REST API
      - "6334:6334"   # gRPC (optional but recommended)
    volumes:
      - qdrant_data:/qdrant/storage
    restart: unless-stopped

  opensearch:
    image: opensearchproject/opensearch:2.14.0
    container_name: opensearch
    environment:
      - discovery.type=single-node
      - plugins.security.disabled=true
      - OPENSEARCH_INITIAL_ADMIN_PASSWORD=StrongPass123!
      - OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m

    ports:
      - "9200:9200"
    volumes:
      - opensearch_data:/usr/share/opensearch/data
    restart: unless-stopped


  elasticsearch:
    image: docker.elastic.co/elasticsearch/elasticsearch:9.2.1
    container_name: elasticsearch
    environment:
      - discovery.type=single-node
      - xpack.security.enabled=false
      - ES_JAVA_OPTS=-Xms1g -Xmx1g
    ports:
      - "9200:9200"   # REST API
      - "9300:9300"   # Transport
    volumes:
      - es_data:/usr/share/elasticsearch/data
    networks:
      - elastic-net


volumes:
  chroma_data:
  redis_data:
  cassandra_data:
  neo4j_data:
  neo4j_logs:
  neo4j_import:
  neo4j_plugins:
  oracle-data:

  etcd_data:
  minio_data:
  milvus_data:
  weaviate_data:
  qdrant_data:
  opensearch_data:
  #  Elasticsearch
  es_data:

networks:
  elastic-net:



